unit_tests:
    - name: full_refresh_mode
      description: "Check taxi trips consistent layer sql with full refresh mode"
      model: taxi_trips_consistent
      overrides:
        macros:
          is_incremental: false
      given:
        - input: source('taxi_trips', 'taxi_trips_raw')
          format: csv
          fixture: taxi_trips_raw
      expect:
        format: csv
        fixture: taxi_trips_consistent


    - name: incremental_mode_with_no_new_data
      description: "Check taxi trips consistent layer sql with incremental mode and no new data"
      model: taxi_trips_consistent
      overrides:
        macros:
          is_incremental: true
      given:
        - input: source('taxi_trips', 'taxi_trips_raw')
          format: csv
          fixture: taxi_trips_raw
        - input: this
          format: csv
          fixture: taxi_trips_consistent
      expect:
        rows: []

    - name: incremental_mode_with_new_data
      description: "Check taxi trips consistent layer sql with incremental mode and new data"
      model: taxi_trips_consistent
      overrides:
        macros:
          is_incremental: true
      given:
        - input: source('taxi_trips', 'taxi_trips_raw')
          format: csv
          fixture: taxi_trips_raw_new_data
        - input: this
          format: csv
          fixture: taxi_trips_consistent
      expect:
        format: csv
        fixture: taxi_trips_consistent_new_data

